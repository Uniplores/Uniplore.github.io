<div id="rolePlay">
  <div class="rolePlayData">
    <div class="top">
      <div class="title">
        <%- theme.rolePlay.title %>
      </div>
      <div class="detail">
        <%- theme.rolePlay.detail %>
      </div>
    </div>

    <div class="splitBar"></div>

    <div class="center">
      <%
        var imgArr = theme.imgs;
        var swpiers = imgArr;
        var swiperLength = swpiers.length;
      %>
      <div class="swiper-length" style="display: none;"><%- swiperLength %>
      </div>
      <div id="appSwiper"
          class="<% if(swiperLength <= 1) { %>swiper-no-swiping<% } %>"
          @mouseenter="stopAutoPlay()" @mouseleave="startAutoPlay()">
        <swiper v-cloak ref="mySwiper" :options="swiperOptions"
            @slideChangeTransitionEnd="slideChangeTransitionEnd">

          <% swpiers.forEach(function (imgUrl) { %>

          <swiper-slide>
            <div class="item swiper-lazy"
                data-background="<%- url_for(imgUrl || theme.swiper.defaultImg) %>"
                style=" background-size: cover; background-repeat: no-repeat;"
                style="position: relative;">
              <div class="swiper-bgmask"
                  style="position: absolute;top: 0;left: 0;width: 100%;height: 100%;">
              </div>
              <div class="flag" style="z-index: 2;">
                <div class="img-mask swiper-lazy"
                    data-background="<%- url_for(imgUrl || theme.swiper.defaultImg) %>"
                    style="height: 100%; background-size: cover; 
                            background-position: center center;">
                  <div
                      class="swiper-lazy-preloader swiper-lazy-preloader-white">
                  </div>
                </div>
              </div>
            </div>

          </swiper-slide>
          <% }) %>
          <div class="swiper-pagination" slot="pagination" pointer
              style="<% if(!theme.swiper.showIndicators || swiperLength <= 1) { %>display: none;<% } %>">
          </div>
          <div class="swiper-button-prev swiper-button-white" pointer
              slot="button-prev"
              style="<% if(!theme.swiper.showPrevNext || swiperLength <= 1) { %>display: none;<% } %>">
          </div>
          <div class="swiper-button-next swiper-button-white" pointer
              slot="button-next"
              style="<% if(!theme.swiper.showPrevNext || swiperLength <= 1) { %>display: none;<% } %>">
          </div>



        </swiper>
      </div>

    </div>
  </div>
</div>

<script>
  var loop = JSON.parse('<%= theme.swiper.loop %>');
  var effect = '<%= theme.swiper.effect %>';
  var delay = '<%= theme.swiper.delay %>';
  var autoplay = JSON.parse('<%= theme.swiper.autoplay %>');
  var vm = new Vue({
    el: "#rolePlay",
    data: {
      swiperOptions: {
        pagination: {
          el: '.swiper-pagination',
          clickable: true // 允许点击小圆点跳转
        },
        loop: loop ? true : false,
        effect, // fade
        autoplay: autoplay ? {
          delay,
          disableOnInteraction: false // 手动切换之后继续自动轮播
        } : false,
        navigation: {
          nextEl: '.swiper-button-next',
          prevEl: '.swiper-button-prev',
        },
        lazy: {
          loadPrevNext: true,
        },
        on: {
          init: function() {
            swiperAnimateCache(this); //隐藏动画元素 
            swiperAnimate(this); //初始化完成开始动画
          },
          slideChangeTransitionEnd: function() {
            swiperAnimate(this); //每个slide切换结束时也运行当前slide动画
          }
        }
        // Some Swiper option/callback...
      }
    },
    computed: {
      swiper() {
        return this.$refs.mySwiper.$swiper
      }
    },
    mounted() {},
    methods: {
      stopAutoPlay() {
        autoplay && this.swiper.autoplay.stop();
      },
      startAutoPlay() {
        autoplay && this.swiper.autoplay.start();
      },
      slideChangeTransitionEnd() {
        console.log('1');
      },
    },
    created() {}
  });
</script>
<style>
  #rolePlay {
    width: 100%;
    min-height: 100vh;
    margin: 0 auto;
    color: #ffffff;
    z-index: 0;
  }

  .rolePlayData {
    margin: 0 10%;
    width: 80%;
    height: 100%;
    display: flex;
    flex-direction: column;
    justify-content: center;

    .top {
      display: flex;
      flex-direction: column;
      align-items: flex-start;
      margin-bottom: 50px;

      .title {
        font-weight: bold;
        font-size: 22px;
        margin-bottom: 40px;
      }

      .detail {
        line-height: 2;
        font-size: 16px;
      }
    }

    .center {
      width: 100%;
      height: 80%;

      /* .swiper-slide {
        width: 100%;
        height: 100%;
      } */


      .swiper-button-prev {
        padding: 10px 10px;
        transition: background 0.2s;

        &:hover {
          background: rgba(0, 0, 0, 0.2);
        }
      }

      .swiper-button-next {
        padding: 10px 10px;
        transition: background 0.2s;

        &:hover {
          background: rgba(0, 0, 0, 0.2);
        }
      }


      .swiper-pagination-bullet-active {
        opacity: 1;
        background-color: <%- theme.color_scheme.common.link %> !important;
      }
    }
  }
</style>